apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: k8s-in-k8s
  namespace: argocd
spec:
  project: default
  source:
    repoURL: git@github.com:ulrikof/DCST2900-K8s.git
    targetRevision: main
    path: ArgoCD/charts/k8s-in-k8s
    helm:
      values: |
        loadBalancerIP: 10.100.39.110
        configLbIP: 10.100.39.111
        controlPlaneImage: https://factory.talos.dev/image/38a5e9b9cfbaeb1054642d93fe3db18befe3e3e1d85a8a96524cdb9acb0643a6/v1.9.5/metal-amd64.qcow2
        workerImage: https://factory.talos.dev/image/74a619d5d808973b6fc5f0d20e34ca3c9994720cc5094a05b087dacf8574649a/v1.9.5/metal-amd64.qcow2
  destination:
    server: https://kubernetes.default.svc
    namespace: k8s-in-k8s
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true